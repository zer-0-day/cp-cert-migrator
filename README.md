# CPCertMigrator

**–≠–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ CryptoPro CSP** - –ø—Ä–æ—Å—Ç–æ –∏ –±—ã—Å—Ç—Ä–æ

## üéØ –ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å?

### üì§ [–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª—ã (—ç–∫—Å–ø–æ—Ä—Ç)](#—ç–∫—Å–ø–æ—Ä—Ç-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤-–≤-—Ñ–∞–π–ª—ã)
```powershell
Install-Module CPCertMigrator -Scope CurrentUser
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\–ú–æ–∏–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" -Password "–ú–æ–π–ü–∞—Ä–æ–ª—å123"
```

### üì• [–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–∑ —Ñ–∞–π–ª–æ–≤ (–∏–º–ø–æ—Ä—Ç)](#–∏–º–ø–æ—Ä—Ç-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤-–∏–∑-—Ñ–∞–π–ª–æ–≤)
```powershell
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "C:\–ú–æ–∏–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" -Password "–ú–æ–π–ü–∞—Ä–æ–ª—å123"
```

### üîÑ [–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä](#–ø–µ—Ä–µ–Ω–æ—Å-–Ω–∞-–¥—Ä—É–≥–æ–π-–∫–æ–º–ø—å—é—Ç–µ—Ä)
```powershell
# –ù–∞ —Å—Ç–∞—Ä–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "D:\–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" -Password "–ü–∞—Ä–æ–ª—å–î–ª—è–ü–µ—Ä–µ–Ω–æ—Å–∞"

# –ù–∞ –Ω–æ–≤–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å  
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "D:\–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" -Password "–ü–∞—Ä–æ–ª—å–î–ª—è–ü–µ—Ä–µ–Ω–æ—Å–∞"
```

### üéÆ [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –º–µ–Ω—é (–¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)](#–ø—Ä–æ—Å—Ç–æ–µ-–º–µ–Ω—é)
```powershell
Install-Module CPCertMigrator -Scope CurrentUser
Start-CryptoProCertMigrator
```

---

## üìã –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –≠–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª—ã

**–ó–∞—á–µ–º:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞

```powershell
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–¥—É–ª—å (–æ–¥–∏–Ω —Ä–∞–∑)
Install-Module CPCertMigrator -Scope CurrentUser

# 2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\–ú–æ–∏–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" -Password "–ú–æ–π–ü–∞—Ä–æ–ª—å123"
```

**–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ:** –ü–∞–ø–∫–∞ —Å —Ñ–∞–π–ª–∞–º–∏ .pfx, –∫–∞–∂–¥—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

### –ò–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤

**–ó–∞—á–µ–º:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

```powershell
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–∑ –ø–∞–ø–∫–∏
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "C:\–ú–æ–∏–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" -Password "–ú–æ–π–ü–∞—Ä–æ–ª—å123"
```

**–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ:** –í—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Windows

### –ü–µ—Ä–µ–Ω–æ—Å –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä

**–ó–∞—á–µ–º:** –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å –æ–¥–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–∞ –¥—Ä—É–≥–æ–π

```powershell
# –ù–ê –°–¢–ê–†–û–ú –ö–û–ú–ü–¨–Æ–¢–ï–†–ï:
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "D:\–î–ª—è–ü–µ—Ä–µ–Ω–æ—Å–∞" -Password "–ü–∞—Ä–æ–ª—å–ü–µ—Ä–µ–Ω–æ—Å–∞"

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É D:\–î–ª—è–ü–µ—Ä–µ–Ω–æ—Å–∞ –Ω–∞ –Ω–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä

# –ù–ê –ù–û–í–û–ú –ö–û–ú–ü–¨–Æ–¢–ï–†–ï:
Install-Module CPCertMigrator -Scope CurrentUser
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "D:\–î–ª—è–ü–µ—Ä–µ–Ω–æ—Å–∞" -Password "–ü–∞—Ä–æ–ª—å–ü–µ—Ä–µ–Ω–æ—Å–∞"
```

### –ü—Ä–æ—Å—Ç–æ–µ –º–µ–Ω—é

**–ó–∞—á–µ–º:** –ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
Start-CryptoProCertMigrator

# –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:
# 1. –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
# 2. –≠–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤  
# 3. –ò–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
# 4. –ë—ã—Å—Ç—Ä–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```

–ú–µ–Ω—é –ø—Ä–æ–≤–µ–¥–µ—Ç –≤–∞—Å —á–µ—Ä–µ–∑ –≤—Å–µ —à–∞–≥–∏ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏.

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Windows** —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º **CryptoPro CSP**
- **PowerShell** (—É–∂–µ –µ—Å—Ç—å –≤ Windows)
- **–ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** –Ω–µ –Ω—É–∂–Ω—ã (–∫—Ä–æ–º–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞)

## ÔøΩ  –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å
```powershell
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
Get-CryptoProCertificates -Scope CurrentUser
```

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä (WhatIf)
```powershell
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –±—É–¥–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ (–±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\Test" -Password "Pass" -WhatIf
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
```powershell
# –¢–æ–ª—å–∫–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\Backup" -Password "Pass" -SubjectFilter "–ú–æ—è–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è"
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```powershell
# –î–æ–±–∞–≤—å—Ç–µ -Verbose –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\Backup" -Password "Pass" -Verbose
```

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**–ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å –æ—Ç —Ñ–∞–π–ª–æ–≤** - –±–µ–∑ –ø–∞—Ä–æ–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–ª—å–∑—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–µ—Å—è –ø–∞—Ä–æ–ª–∏

**–ù—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞?** - –Ω–µ—Ç, –∫—Ä–æ–º–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (LocalMachine)

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏?** - –¥–∞, –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ, –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

**–ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ —É –º–µ–Ω—è –µ—Å—Ç—å?** - `Get-CryptoProCertificates -Scope CurrentUser`

## üìû –ü–æ–º–æ—â—å

```powershell
# –°–ø—Ä–∞–≤–∫–∞ –ø–æ –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥–µ
Get-Help Export-CryptoProCertificates -Examples
```

---
**–ê–≤—Ç–æ—Ä:** zeroday | ‚≠ê [–ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É –Ω–∞ GitHub](https://github.com/zer-0-day/cp-cert-migrator)