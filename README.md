# CPCertMigrator

**–≠–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ CryptoPro CSP** - –ø—Ä–æ—Å—Ç–æ –∏ –±—ã—Å—Ç—Ä–æ

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üì§ [–≠–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞](#—ç–∫—Å–ø–æ—Ä—Ç-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤-–≤-—Ñ–∞–π–ª—ã)
```powershell
Install-Module CPCertMigrator -Scope CurrentUser
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\certFolder" -Password "SuperSecurePass"
```

### üì• [–ò–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞](#–∏–º–ø–æ—Ä—Ç-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤-–∏–∑-—Ñ–∞–π–ª–æ–≤)
```powershell
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "C:\certFolder" -Password "SuperSecurePass"
```

### üîÑ [–ü–µ—Ä–µ–Ω–æ—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤](#–ø–µ—Ä–µ–Ω–æ—Å-–Ω–∞-–¥—Ä—É–≥–æ–π-–∫–æ–º–ø—å—é—Ç–µ—Ä)
```powershell
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\certFolder" -Password "SuperSecurePass"

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å  
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "C:\certFolder" -Password "SuperSecurePass"
```

### üéÆ [–ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –º–µ–Ω—é](#–ø—Ä–æ—Å—Ç–æ–µ-–º–µ–Ω—é)
```powershell
Install-Module CPCertMigrator -Scope CurrentUser
Start-CryptoProCertMigrator
```

### üîç [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏?](#–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-–º–æ–¥—É–ª—å)

---

## üìã –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –≠–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª—ã

**–ó–∞—á–µ–º:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞

```powershell
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å
Install-Module CPCertMigrator -Scope CurrentUser

# 2. –õ–∏–±–æ –æ–±–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å
Update-Module CPCertMigrator -Scope CurrentUser

# 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\certFolder" -Password "SuperSecurePass"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–∞–ø–∫–∞ —Å —Ñ–∞–π–ª–∞–º–∏ .pfx, –∫–∞–∂–¥—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

### –ò–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤

**–ó–∞—á–µ–º:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

```powershell
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–∑ –ø–∞–ø–∫–∏
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "C:\certFolder" -Password "SuperSecurePass"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Windows

### –ü–µ—Ä–µ–Ω–æ—Å –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä

**–ó–∞—á–µ–º:** –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å –æ–¥–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–∞ –¥—Ä—É–≥–æ–π

```powershell
# –ù–ê –°–¢–ê–†–û–ú –ö–û–ú–ü–¨–Æ–¢–ï–†–ï:
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\certFolder" -Password "SuperSecurePass"

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É C:\certFolder –Ω–∞ –Ω–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä

# –ù–ê –ù–û–í–û–ú –ö–û–ú–ü–¨–Æ–¢–ï–†–ï:
Install-Module CPCertMigrator -Scope CurrentUser
Import-CryptoProCertificates -Scope CurrentUser -ImportFolder "C:\certFolder" -Password "SuperSecurePass"
```

### –ü—Ä–æ—Å—Ç–æ–µ –º–µ–Ω—é

**–ó–∞—á–µ–º:** –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª—è

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
Start-CryptoProCertMigrator

# –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:
# 1. –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
# 2. –≠–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤  
# 3. –ò–º–ø–æ—Ä—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
# 4. –ë—ã—Å—Ç—Ä–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```

–ú–µ–Ω—é —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏.

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Windows 10, Windows Server 2016 –∏ –≤—ã—à–µ ** —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º **CryptoPro CSP**
- **PowerShell 5.1 –∏ –≤—ã—à–µ**
- **–ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** (—Ç–æ–ª—å–∫–æ –¥–ª—è LocalMachine)

## ÔøΩÔøΩ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –µ—Å—Ç—å
```powershell
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
Get-CryptoProCertificates -Scope CurrentUser
```

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä (WhatIf)
```powershell
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –±—É–¥–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ (–±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\Test" -Password "Pass" -WhatIf
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
```powershell
# –¢–æ–ª—å–∫–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\Backup" -Password "Pass" -SubjectFilter "–ú–æ—è–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è"
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
```powershell
# –î–æ–±–∞–≤—å—Ç–µ -Verbose –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞
Export-CryptoProCertificates -Scope CurrentUser -ExportFolder "C:\Backup" -Password "Pass" -Verbose
```


## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**–ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å –æ—Ç —Ñ–∞–π–ª–æ–≤** - –±–µ–∑ –ø–∞—Ä–æ–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–ª—å–∑—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–µ—Å—è –ø–∞—Ä–æ–ª–∏

**–ù—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞?** - –Ω–µ—Ç, –∫—Ä–æ–º–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (LocalMachine)

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏?** - –¥–∞, –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ, –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

## üìû –ü–æ–º–æ—â—å

```powershell
# –°–ø—Ä–∞–≤–∫–∞ –ø–æ –ª—é–±–æ–π –∫–æ–º–∞–Ω–¥–µ
Get-Help Export-CryptoProCertificates -Examples
```

## üîç –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥—É–ª—å

### –ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏ –∏–º–ø–æ—Ä—Ç–∞ –≠–¶–ü

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:**
- **Windows Certificate Store** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Windows
- –ü—É—Ç—å: `Cert:\CurrentUser\My` –∏–ª–∏ `Cert:\LocalMachine\My`
- –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞

**–ú–µ—Ö–∞–Ω–∏–∑–º —ç–∫—Å–ø–æ—Ä—Ç–∞:**
```powershell
Export-PfxCertificate -FilePath $filePath -Password $password
```
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π PowerShell cmdlet
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç **PFX (PKCS#12)**
- –í–∫–ª—é—á–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç + –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á

**–ú–µ—Ö–∞–Ω–∏–∑–º –∏–º–ø–æ—Ä—Ç–∞:**
```powershell
Import-PfxCertificate -FilePath $file -CertStoreLocation $store -Exportable
```
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π PowerShell cmdlet
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ **PFX (PKCS#12)**
- –§–ª–∞–≥ `-Exportable` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CryptoPro CSP

- **CryptoPro CSP** —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ Cryptographic Service Provider –≤ Windows
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã CryptoPro **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã** —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Windows API
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö CryptoPro
- –ú–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Windows –º–µ—Ö–∞–Ω–∏–∑–º—ã**, –ø–æ—ç—Ç–æ–º—É —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –ª—é–±—ã–º–∏ CSP

### –ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

‚úÖ **X.509 —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** (–ø—É–±–ª–∏—á–Ω–∞—è —á–∞—Å—Ç—å)  
‚úÖ **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á** (–∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ CryptoPro)  
‚úÖ **–¶–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** (–µ—Å–ª–∏ –µ—Å—Ç—å)  
‚úÖ **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** (FriendlyName, etc.)

‚ùå **–ù–ï —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è:** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CryptoPro CSP, –ª–∏—Ü–µ–Ω–∑–∏–∏, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç—å** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ Windows API
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ CSP, –Ω–µ —Ç–æ–ª—å–∫–æ CryptoPro  
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ Microsoft cmdlets
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∑–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–º PFX
- **–ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å** - PFX —Ñ–∞–π–ª—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –ª—é–±—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

---
**–ê–≤—Ç–æ—Ä:** zeroday | ‚≠ê [–ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É –Ω–∞ GitHub](https://github.com/zer-0-day/cp-cert-migrator) 